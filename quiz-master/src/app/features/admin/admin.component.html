    <div class="container mx-auto p-4 max-w-4xl">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Create New Quiz</h1>
        <a routerLink="/" class="text-blue-600 hover:underline">Back to Home</a>
      </div>

      <form [formGroup]="quizForm" (ngSubmit)="downloadQuiz()" class="space-y-6">
        <!-- Quiz Details -->
        <div class="bg-white p-6 rounded-lg shadow">
          <h2 class="text-xl font-semibold mb-4">Quiz Details</h2>
          <div class="grid grid-cols-1 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700">Quiz ID (Filename)</label>
              <input formControlName="id" type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
              <p class="text-xs text-gray-500">Used for filename, e.g., 'js-basics' -> 'js-basics.json'</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Title</label>
              <input formControlName="title" type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Description</label>
              <textarea formControlName="description" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"></textarea>
            </div>
          </div>
        </div>

        <!-- Questions -->
        <div formArrayName="questions" class="space-y-6">
          @for (question of questions.controls; track i; let i = $index) {
            <div [formGroupName]="i" class="bg-white p-6 rounded-lg shadow relative">
              <button type="button" (click)="removeQuestion(i)" class="absolute top-4 right-4 text-red-600 hover:text-red-800">
                Remove Question
              </button>
              
              <h3 class="text-lg font-medium mb-4">Question {{ i + 1 }}</h3>
              
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700">Question Text</label>
                  <textarea formControlName="text" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"></textarea>
                </div>

                <!-- Code Snippet Toggle -->
                <div class="flex items-center">
                   <input type="checkbox" [id]="'hasCode'+i" (change)="toggleCodeSnippet(i, $event)" [checked]="hasCodeSnippet(i)" class="mr-2">
                   <label [for]="'hasCode'+i">Include Code Snippet</label>
                </div>

                @if (hasCodeSnippet(i)) {
                  <div formGroupName="codeSnippet" class="bg-gray-50 p-4 rounded border">
                    <div class="grid grid-cols-1 gap-4">
                      <div>
                        <label class="block text-sm font-medium text-gray-700">Language</label>
                        <select formControlName="language" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                          <option value="javascript">JavaScript</option>
                          <option value="typescript">TypeScript</option>
                          <option value="python">Python</option>
                          <option value="html">HTML</option>
                          <option value="css">CSS</option>
                        </select>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-gray-700">Code</label>
                        <textarea formControlName="code" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border font-mono text-sm"></textarea>
                      </div>
                    </div>
                  </div>
                }

                <!-- Options -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Options</label>
                  <div formArrayName="options" class="space-y-2">
                    @for (option of getOptions(i).controls; track j; let j = $index) {
                      <div [formGroupName]="j" class="flex items-center gap-2">
                        <input type="radio" [name]="'correctOption'+i" [value]="option.get('id')?.value" 
                               (change)="setCorrectOption(i, option.get('id')?.value)"
                               [checked]="question.get('correctOptionId')?.value === option.get('id')?.value">
                        <input formControlName="text" type="text" class="block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="Option Text">
                        <button type="button" (click)="removeOption(i, j)" class="text-red-500 hover:text-red-700">Ã—</button>
                      </div>
                    }
                  </div>
                  <button type="button" (click)="addOption(i)" class="mt-2 text-sm text-blue-600 hover:underline">
                    + Add Option
                  </button>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700">Explanation</label>
                  <textarea formControlName="explanation" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"></textarea>
                </div>
              </div>
            </div>
          }
        </div>

        <button type="button" (click)="addQuestion()" class="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors">
          + Add Question
        </button>

        <div class="flex justify-end pt-6">
          <button type="submit" [disabled]="quizForm.invalid" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed">
            Download Quiz JSON
          </button>
        </div>
      </form>
    </div>
